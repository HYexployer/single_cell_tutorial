# 单细胞测序-最佳的分析Pipeline

- 作者：starlitnightly
- 日期：2023.07.14

!!! note 楔子
    从事单细胞分析也有一段时间了，国内大部分中文教程都是使用R语言进行分析，使用Python的还比较少，或者是直译scanpy的教程，不过scanpy可能已经比较旧了。在这里，我们参考了[Single cell best practice](https://www.sc-best-practices.org/preamble.html),希望能给国内的从业者带来一个完善的教程指引以及分析。
    

## 简介 

人体是一个复杂的机器，严重依赖于生命的基本单位——细胞。细胞可以分为不同类型，在发育过程中甚至会发生转变，在疾病或再生时也会如此。这种细胞的异质性在形态、功能和基因表达谱上都有所体现。强烈的干扰会导致细胞类型的紊乱，从而影响整个系统，甚至引发像癌症这样严重的疾病[Macaulay等人，2017]。因此，了解细胞在正常状态和干扰下的行为对于改善我们对整个细胞系统的理解至关重要。

这项庞大的任务可以通过不同的方式来解决，其中最有前途的方法是在个体水平上对细胞进行分析。到目前为止，每个细胞的转录组主要是通过一种称为单细胞RNA测序的过程来检测的。随着单细胞基因组学的最新进展，现在可以将转录组信息与空间、染色质可及性或蛋白质信息结合起来。这些进展不仅可以揭示复杂的调控机制，而且还增加了数据分析师的复杂性。

如今，数据分析师面临着一个庞大的分析工具领域，其中包含1000多种计算单细胞分析方法。在这个广泛的工具范围中导航以生成科学前沿的可靠结果变得越来越具有挑战性。

## 本书内容概述

本书的目标是教新手和专业人士单细胞测序分析的最佳实践，在Python中。本书将教您从预处理到可视化、统计评估等一系列常见的分析步骤，以及更深入的内容。通读本书将使您能够独立分析单模态和多模态单细胞测序数据。本书中的指南和建议不仅旨在教授您如何进行单细胞分析，而且着重于如何正确进行分析。我们的建议尽可能地基于外部基准和评价。最后，我们将本书视为单细胞数据分析师的一份实用资源，可以在推荐发生变化时轻松更新。

## 本书内容不涉及

本书不涵盖生物学或计算机科学的基础知识，包括编程。此外，本书也不是为特定任务设计的所有分析工具的完整集合。我们特别强调那些经过外部验证的工具，这些工具在处理手头的数据时效果最佳，或者是经过社区验证的最佳实践方法。如果不可能进行外部验证，我们只会基于自己广泛的经验推荐工作流程。

## 本书的结构

本书的每一章对应于典型单细胞数据分析项目的不同阶段。通常，分析工作流程会按照章节的顺序进行，但在下游分析目标方面可能存在一定的灵活性。我们的每一章都包含了大量的参考文献，我们鼓励读者查阅我们陈述观点的原始来源。尽管我们在可能的情况下试图提供所需的背景知识，但我们的总结并不能始终捕捉到我们推荐的全部理由。

## 学习前准备

生物信息学对于新手来说是一个具有挑战性的研究领域，因为它需要对生物学和计算机科学都有一定的了解。而单细胞分析则更加具有要求，因为它结合了许多子领域，而且数据集通常较大。本书无法涵盖计算单细胞分析的所有先决条件，因此我们建议您在下面对各种主题进行粗略的概述。以下链接可能会提升您在本书中的学习体验：

基本的Python编程。您应该熟悉控制流程（循环、条件语句等）、基本数据结构（列表、字典、集合）以及最常用库（如Pandas和Numpy）的核心功能。如果您对编程和Python还不熟悉，我们强烈推荐北京理工大学的嵩天老师的Python相关的mooc，包括[Python基础学习](https://www.icourse163.org/course/BIT-268001)与[Python数据处理与可视化](https://www.icourse163.org/course/BIT-1001870002)两节。

了解AnnData和scanpy包的基础知识会有益，但不是绝对必需的。本书对AnnData的介绍足以让您跟上，并介绍了使用scanpy的工作流程。然而，我们无法在本书的过程中介绍scanpy的所有功能。如果您对scanpy还不熟悉，我们强烈建议您通过学习[scanpy教程](https://scanpy.readthedocs.io/en/stable/tutorials.html)，并偶尔查看[scanpy的API](https://scanpy.readthedocs.io/en/stable/api.html)参考来学习。

如果您对多模态数据分析感兴趣，建议了解muon和MuData的基础知识。本书对MuData进行了更详细的介绍，但只是简要介绍了muon，类似于AnnData和scanpy。[muon教程](https://muon-tutorials.readthedocs.io/en/latest/)是学习使用muon进行多模态数据分析的很好入门资料。

生物学基础知识。虽然我们大致介绍了数据的产生过程，但我们不会涵盖DNA、RNA和蛋白质的基础知识。如果您对分子生物学完全不熟悉，建议阅读Bruce Alberts等人的《细胞分子生物学》（Molecular Biology of the Cell）。

## License

<a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img alt="知识共享许可协议" style="border-width:0" src="https://img.shields.io/badge/license-CC%20BY--NC--SA%204.0-lightgrey" /></a>

本作品采用<a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">知识共享署名-非商业性使用-相同方式共享 4.0 国际许可协议</a>进行许可。在此再次感谢Single-cell best practices对单细胞教程的贡献，本书将基于Single-cell best practices结合作者自身的分析经验来完成。